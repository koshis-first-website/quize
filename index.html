<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blue Zen - Infinite Quiz</title>
    <style>
        /* 1. BLUE THEME & BUBBLES CSS */
        body {
            background: linear-gradient(180deg, #1e3a8a 0%, #3b82f6 100%);
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden; /* Keeps bubbles inside screen */
            position: relative;
        }

        /* Bubble Style */
        .bubble {
            position: absolute;
            bottom: -50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            animation: float 8s infinite ease-in;
            z-index: 0;
        }

        @keyframes float {
            0% { transform: translateY(0) translateX(0); opacity: 0; }
            50% { opacity: 0.5; }
            100% { transform: translateY(-110vh) translateX(50px); opacity: 0; }
        }

        .quiz-container {
            background: rgba(255, 255, 255, 0.95);
            width: 90%;
            max-width: 400px;
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            text-align: center;
            position: relative;
            z-index: 10; /* Keeps quiz above bubbles */
        }

        h2 { color: #1e3a8a; margin-bottom: 20px; font-size: 1.3rem; }

        .btn {
            background: white;
            color: #333;
            border: 2px solid #d1d5db;
            padding: 12px;
            margin: 8px 0;
            border-radius: 12px;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
            transition: 0.3s;
        }

        .btn:hover { border-color: #3b82f6; background: #eff6ff; }

        .correct { background: #22c55e !important; color: white; border-color: #16a34a; }
        .wrong { background: #ef4444 !important; color: white; border-color: #dc2626; }

        #next-btn {
            background: #1e3a8a;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
            font-weight: bold;
        }

        .hide { display: none; }
    </style>
</head>
<body>

    <div class="quiz-container">
        <h2 id="question">Connecting to Zen Web...</h2>
        <div id="answer-buttons"></div>
        <button id="next-btn" class="hide">Continue Journey</button>
    </div>

    <script>
        // 2. BUBBLE GENERATOR
        function createBubbles() {
            for (let i = 0; i < 15; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                const size = Math.random() * 60 + 10 + "px";
                bubble.style.width = size;
                bubble.style.height = size;
                bubble.style.left = Math.random() * 100 + "vw";
                bubble.style.animationDelay = Math.random() * 8 + "s";
                bubble.style.animationDuration = Math.random() * 5 + 7 + "s";
                document.body.appendChild(bubble);
            }
        }
        createBubbles();

        // 3. WEB API & QUIZ LOGIC
        const questionElement = document.getElementById('question');
        const answerButtonsElement = document.getElementById('answer-buttons');
        const nextButton = document.getElementById('next-btn');

        let questions = [];
        let currentQuestionIndex = 0;

        async function fetchFromWeb() {
            try {
                // Fetching Nature/Science/Health (Category 17)
                const response = await fetch('https://opentdb.com/api.php?amount=20&category=17&type=multiple');
                const data = await response.json();
                
                questions = data.results.map(q => ({
                    question: decodeHTML(q.question),
                    answers: shuffle([
                        { text: decodeHTML(q.correct_answer), correct: true },
                        ...q.incorrect_answers.map(a => ({ text: decodeHTML(a), correct: false }))
                    ])
                }));
                showQuestion();
            } catch (e) {
                questionElement.innerText = "Offline. Please check internet!";
            }
        }

        function showQuestion() {
            resetState();
            let q = questions[currentQuestionIndex];
            questionElement.innerText = q.question;
            q.answers.forEach(ans => {
                const btn = document.createElement('button');
                btn.innerText = ans.text;
                btn.classList.add('btn');
                if (ans.correct) btn.dataset.correct = "true";
                btn.addEventListener('click', selectAnswer);
                answerButtonsElement.appendChild(btn);
            });
        }

        function resetState() {
            nextButton.classList.add('hide');
            while (answerButtonsElement.firstChild) answerButtonsElement.removeChild(answerButtonsElement.firstChild);
        }

        function selectAnswer(e) {
            const selected = e.target;
            const isCorrect = selected.dataset.correct === "true";
            if (isCorrect) selected.classList.add('correct');
            else selected.classList.add('wrong');
            
            Array.from(answerButtonsElement.children).forEach(btn => {
                if(btn.dataset.correct === "true") btn.classList.add('correct');
                btn.disabled = true;
            });
            nextButton.classList.remove('hide');
        }

        nextButton.addEventListener('click', () => {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) showQuestion();
            else {
                questionElement.innerText = "Zen Master Status Achieved!";
                nextButton.innerText = "Restart";
                nextButton.onclick = () => location.reload();
            }
        });

        function shuffle(arr) { return arr.sort(() => Math.random() - 0.5); }
        function decodeHTML(html) {
            const txt = document.createElement("textarea");
            txt.innerHTML = html;
            return txt.value;
        }

        fetchFromWeb();
    </script>
</body>
</html>
